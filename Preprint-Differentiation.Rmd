---
title: "Does differentiation beget differentiation?"
subtitle: Examining the link between exposure to and support for differentiated integration
author: "Martin Moland^[ARENA, Centre for European Studies]"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output: pdf_document
abstract: "Questions about the public legitimacy of the EU's current flexible integration are becoming increasingly important in the public opinion literature. However, we still know little about how exposure to past differentiation shapes public preferences for a more differentiated EU. Combining survey data from 2020-21 with data detailing EU countries’ differentiations from the EU treaties I show that citizens of countries previously exposed to differentiations from the EU’s legal order are more likely to want a less uniform EU integration in the future. This has implications both for the debate about the shape of the future EU and the broader literature investigating public support for transnational cooperation."
csl: european-journal-of-political-research.csl
bibliography: bib_file.bib
header-includes: 
  - \usepackage{setspace}\doublespacing
  - \usepackage{float}
fontsize: 12pt

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Introduction

Even if the EU is among the world’s most advanced political cooperations, one of the main stories of the EU’s recent development is its increasingly fragmented integration of particularly salient areas [@leuffen_differentiated_2013;@schimmelfennig_ever_2020]. The EU’s political integration has typically been differentiated for two reasons: First, some member states have opted out of cooperation to protect their own sovereignty. This is called “constitutional differentiation”. Second, through a process known as “instrumental differentiation”, countries have integrated into policy cooperation according to different timetables. Both modes of differentiation can either be chosen by the member states themselves or, as was the case for Central and Eastern Europe, externally imposed [@schimmelfennig_instrumental_2014]. Because of these forms of differentiation, the EU’s current shape is best characterised as one of ‘variable geometry’ [@stubb_categorization_1996] rather than ‘ever closer Union’.

While we increasingly know a lot about why people support such deviations from uniform integration [@telle_elite-mass_2022-1; @leuffen_public_2020], we do not know whether living in a country that has had a diverging path of integration from that taken by the other EU member states shapes current preferences for a less uniform EU. While one of the few existing contributions examining the causal effect of differentiation on support for EU democracy finds a positive correlation between the two [@schraff_does_2020], two knowledge gaps remain: First, we know too little about how past experiences with differentiation changes public preferences for a future differentiated EU. Second, we do not know whether the mode of implementation of differentiation affects these preferences. This paper seeks to fill those gaps.

By combining survey data from 2020-2021 on citizens’ attitudes towards constitutional differentiated integration with data detailing their countries’ differentiations from EU treaties, this paper finds that support for differentiated integration is greater among citizens whose countries have had a greater number of differentiations from EU treaties. This is especially the case for Eurosceptics. This holds both where the differentiation was voluntary, as in Scandinavia [@adler-nissen_opting_2014] or externally imposed by the EU’s institutions, as in Central and Eastern Europe [@schimmelfennig_eu_2014]. However, there is one exception: While Eurosceptics living in countries with much previous exposure to past treaty differentiation are broadly more likely to support further differentiation, this does not apply to Central and Eastern Europe. Here Euroscepticism and exposure to differentiated integration seems to produce less support for a more differentiated future EU. I hypothesize that this is either driven by how differentiation has been framed by Central and Eastern European politicians as a threat to the influence of these countries within the relevant states or a historically driven scepticism of a differentiation that has, in these countries, primarily been externally imposed. Thus, my results offer contradictory evidence for a self-reinforcing feedback loop [@busemeyer_beyond_2021] between exposure to differentiation and future support for it: While the main thrust of evidence suggests that greater exposure to differentiation strengthens popular assent, there are also signs of the opposite. This shows that preferences are likely to be determined by a complex interplay of individual characteristics and regional histories of integration.

My findings are relevant to the discussion about the EU's future that Brexit gave rise to [@european_commission_white_2017]: As differentiated integration has become a more important tool of EU governance, especially given the EU’s increasing integration of for instance monetary and fiscal policy [@schimmelfennig_ever_2020; @genschel_differentiated_2013], greater exposure to it among member state citizens may make it more difficult for the EU’s institutions to consolidate support for the project of further integration. The article also makes an important contribution to the emerging literature on public support for international organizations [@dellmuth_legitimacy_2020; @dellmuth_elite_2021; @edwards_public_2009], by showing that implementation of differentiations from international law can potentially increase public demand for future divergences from the same legal order. Lastly the paper shows that differentiation, favoured as a tool for mitigating the contestation provoked by the EU’s increasing integration of particularly salient policy areas [@genschel_market_2018], may complicate the EU’s progress towards its goal of “ever closer Union”.

# Public preferences for European integration - what we know and what we don't

A large literature investigates individual preferences for European integration [@basile_sharing_2020; @bremer_junckers_2020; @de_vries_variable_2013; @eichenberg_post-maastricht_2007; @gabel_public_1998; @hobolt_public_2015; @hooghe_calculation_2005]. The literature identifies three mechanisms that shape preferences for European integration. The first is utilitarian, with support for the EU contingent on whether the individual or social groups with which they identify potentially gain from integration [@foster_economic_2021; @gabel_public_1998]. The second is cue-based, and posits that citizens use informational shortcuts such as elite and media cues to make up their minds about European integration, particularly in less salient policy areas [@harteveld_europe_2013; @marquart_knowing_2019; @steenbergen_whos_2007]. The literature also shows that strong identification with the nation-state makes citizens more likely to oppose EU integration [@borzel_identity_2020; @hooghe_calculation_2005; @luedtke_european_2005].

However, we know much less about why people support a less uniform European Union. This is despite the fact that a large literature investigates differentiated integration, as this form of flexible integration is commonly called, conceptually [@batora_towards_2020; @leuffen_differentiated_2013; @schimmelfennig_instrumental_2014; @schimmelfennig_ever_2020], empirically [@ganzle_differentiated_2019; @malang_political_2020; @schimmelfennig_eastern_2017; @winzen_government_2020; @ott_between_2017] and normatively [@bellamy_ever_2013; @eriksen_contesting_2019; @lord_autonomy_2021; @nicolaidis_new_2004]. The few existing contributions probing the question of individual support for differentiated integration points to either liberal economic values [@leuffen_public_2020], Euroscepticism [@de_blok_blessing_2020] and party cueing [@telle_elite-mass_2022-1] as important predictors. 

This literature, in other words, mostly focuses on predictors found at the level of individuals. However, popular attitudes towards both the EU and international cooperation more broadly are often shaped by elite cues and context [@dellmuth_elite_2021; @edwards_public_2009; @harteveld_europe_2013; @telle_elite-mass_2022-1]. One under-explored source of such support is the large variation in differentiated integration found across the EU [@schimmelfennig_instrumental_2014]: As either externally imposed or voluntarily chosen differentiation may be either in or out of step with popular attitudes towards how the EU should look, past differentiation may face a popular response in the form of lesser or greater support for differentiation [@busemeyer_beyond_2021; @wlezien_public_1995]. While previous literature has investigated how this feedback mechanism plays out in the case of EU policies [@bolstad_dynamics_2015; @de_bruycker_democratically_2020], this paper will instead investigate how differentiations from the EU's primary legal framework shapes demand for a differently configured polity.

The effect of exposure to differentiation may also be compounded by who originally initiated differentiations, and the circumstances under which it happened. An interesting test of this assumption is support for differentiation in Central and Eastern Europe. Here citizens were exempt from the right to move across EU borders to seek work for several years after their countries acceded to the EU. Differentiation was thus externally imposed as a precondition for EU membership [@cianciara_differentiated_2014; @schimmelfennig_eu_2014]. This was done because existing member states wanted to shield themselves from the economic destabilization that they feared would follow from the EU accession of countries like Poland, Estonia, and Hungary [@schimmelfennig_eu_2014]. This could easily be seen by those excluded from these policies as a cartelization of the benefits of EU integration [@lord_autonomy_2021 547]. Citizens of Central and Eastern Europe could thus respond to the involuntary nature of the exposure they have had to differentiated integration by expressing lower support for it in the future. 

However, another causal mechanism could explain lower levels of support for differentiated integration in Central and Eastern Europe without relying on a path dependency argument: Central and Eastern European politicians have framed differentiated integration as a path towards an EU consisting of a powerful core and a less powerful periphery. This frame was prominent during the sovereign debt crisis [@cianciara_differentiated_2014 178-179]. For example, Polish politicians opposed further integration of the Eurozone, a clear example of differentiated integration, because they feared that the Eastern member states would become less influential in economic policy-making due to being non-Eurozone countries. Such cues have been known to shape popular attitudes towards integration, particularly where citizens have little knowledge of the relevant policies. It may thus help explain possible opposition to differentiated integration [@steenbergen_whos_2007; @telle_elite-mass_2022-1].

However, increasingly Eurosceptic elite attitudes in Central and Eastern Europe [@borzel_identity_2020; @brack_towards_2020; @kriesi_politicization_2016] could produce the opposite outcome: Greater support for differentiated integration. The reason is once again elite cueing: Where European integration is increasingly framed as a problem, citizens may see less uniform integration as a solution and thus increase their demand for more differentiation. Here, in other words, the causal mechanism would not necessarily be exposure to differentiated integration, but rather how that same differentiation is framed. This yields two competing hypotheses:  
*H1: That support for constitutional differentiated integration will be lower in Central and Eastern countries with more extensive exposure to differentiated integration compared to countries with lower levels of exposure.*  
*H2: That support for constitutional differentiated integration will be higher in Central and Eastern European countries with more extensive exposure to differentiated integration compared to countries with lower levels of exposure.*

Normative literature on differentiated integration [@bellamy_republican_2019; @cheneval_case_2013] has argued that differentiated integration may allow for greater national autonomy. The same argument has been used by Swedish and Danish governments to justify their decisions to opt out of for instance the economic and monetary union [@adler-nissen_opting_2014; @leruth_operationalizing_2015; @spendzharova_banking_2016] Exposure to such cues could manifest itself in greater popular support for constitutional differentiated integration in these countries, and produce the opposite result from that seen in Central and Eastern Europe: As differentiation through opt-outs has explicitly and continuously been framed as a tool for expanding the sovereignty of both Sweden and Denmark, it may enjoy greater support among Scandinavian citizens than what is found in other regions.

Evidence of this is found in how the renewed Danish opt-out from justice and home affairs in 2015 led to stronger trust in EU democracy on the part of those identifying as Eurosceptic [@schraff_does_2020]. This suggests that citizens may respond positively to differentiation, and could indicate that they would be favourably inclined towards further differentiation. This trend might also be particularly strong among Eurosceptics in these countries: These citizens may, because of their countries’ relatively small sizes, be more likely to see differentiation as a viable second-best alternative to the European disintegration they would otherwise have favoured. This could make them more likely than supporters of EU membership to favour further differentiation. I formulate the following hypotheses:  
*H3: The positive effect of exposure to differentiated integration will be greater for citizens of Sweden and Denmark than in the entire EU.*  
*H3a: The increase in support attributable to increased exposure to differentiated integration will be greater for Scandinavian Eurosceptics than supporters of EU membership.*

It is also likely that the Eurosceptic sentiments found to be important for predicting support for differentiated integration [@de_blok_blessing_2020] will compound the effect of exposure to differentiation. This may be because Eurosceptics are arguably more likely than supporters of EU membership to see differentiated integration as a preferable alternative to current uniform integration. This yields the following hypothesis:  
*H4: Support for constitutional differentiated integration will increase more strongly as a function of previous exposure to differentiated integration among Eurosceptics than among those who support EU membership.*

My paper contributes to the emerging literature on public support for differentiated integration by moving it beyond the current focus on individual-level characteristics [@de_blok_blessing_2020; @leuffen_public_2020]. It does so by shifting the focus to how a key contextual factor, the actual level of differentiation, impacts support for constitutional differentiated integration under different modes of implementation. It thus sheds an important light on whether support for a more differentiated EU is impacted by the actual levels of differentiation that citizens have historically been exposed to. This is also important for explaining how path dependencies brought by past international cooperation helps shape support for international organizations' future choices. It thus answers the question of whether differentiation begets further differentiation by solidifying support for a less uniform EU.

# Data and methods
The hypotheses will be investigated using multilevel linear models and data from Yougov surveys fielded in 2020-21 [@hemerijck_eui-yougov_2021]. I combine these data with the expanded EUDIFF1 dataset [@schimmelfennig_eudiff1_2022]. This dataset features all distinct differentiations from the EU treaties, showing for each country the number of articles in which differentiation was given, the years they were in force and the policy areas covered. The surveys, on the other hand, ask a range of questions related to European integration. Two of these ask about preferences for differentiated integration. The first question asks people whether they want an EU where countries may opt out of certain policy integration. This may be termed a constitutionally differentiated EU. The second asks whether the EU should allow countries to arrive at the same level of integration at different speeds when they are ready. This would be an instrumentally differentiated EU. This article focuses on support for constitutional differentiated integration, whose permanent segmentation represents arguably the strongest departure from the EU's current goal of continuously closer integration. Because it allows for both fragmentation with implications for each country's power within the union as well as greater space for national autonomy, attitudes towards  differentiation are likely to be shaped by both sovereigntist discourses and concerns about the relative strength of one's country within the EU.

## Dependent variable
My dependent variable measures support for constitutional differentiated integration. The variable has a six-unit response scale and asks respondents whether they support a constitutionally differentiated EU (“Please tell us how far you agree or disagree with the following statement: Member states should be allowed to opt out of specific areas of European integration…”). The response categories are ordered from 1-5, with 1 being Strongly agree and 5 being strongly disagree. I reverse the coding, so that the scale goes from full disagreement to full agreement. By not asking about “constitutional differentiated integration”, the question becomes easier to understand. It also frames differentiation as a tool for strengthening autonomy and clarifies that countries themselves are able to opt out of policy areas if they so choose. 

## Variables of key interest
To operationalize each country's exposure to EU differentiation I multiply, for each distinct differentiation, the number of articles from which a differentiation has been obtained with the number of years in which the differentiation was in force. This creates a variable for article-years. I then log-transform this variable to reduce the results’ sensitivity to outliers. 

This dataset contains data on differentiations from the EU's treaties, rather than from the directives and regulations that constitute the EU’s main legislative output [@duttle_opting_2017]. This has one key benefit: The issue of differentiations from EU treaty provisions has mostly dealt with differentiation from broad and highly salient policy areas, such as monetary policy or the freedom of movement for workers. It is thus more likely that citizens will be aware of these differentiations, when compared to differentiation from ordinary legislation and technical regulation. By extensions differentiations from treaty law are thus more likely to be part of the backdrop against which citizens make up their mind about the future structure of the EU.

To analyse the regionally specific effects of differentiation, I use dummies for Scandinavian and Central and Eastern European citizenship. I code all Swedish and Danish citizens with a 1 on the Scandinavian dummy, and everyone from Hungary, Lithuania, Poland, and Romania with a 1 on the Central and Eastern European dummy. I then use these dummies to construct subsets of respondents that allow me to analyse the regionally specific effects assumed by *H1*, *H2* and *H3*. 

## Control variables
I operationalize support for liberal economic policies, a relevant control variable [@leuffen_public_2020], through a question that asks whether respondents want to live in a Europe that “stresses economic integration, market competition and fiscal discipline”. This is contrasted to “a global Europe that acts as a leader on climate, human rights and global peace” or “a protective Europe that defends the European way of life and welfare against internal and external threats”. I code those who say that they prefer to live in a primarily market-oriented Europe as 1 and others 0 on this variable. While the question is multi-faceted, by asking about both fiscal discipline that may be described as austerity policies and more general market integration, I believe it still measures a general affinity for economic liberalism.

I include an equally weighted index of questions measuring the evaluations of the economy. These questions are found by a factor analysis, in contrast to a question about the respondent’s perceptions of the local job market, to measure the same underlying dimension (see table A3). Previous literature shows that positive evaluations of the national economy correlate with support for both uniform and differentiated integration (see for instance @gabel_public_1998; @harteveld_europe_2013; @hooghe_calculation_2005; @leuffen_public_2020 [12]). Egotropic evaluations, on the other hand, have been shown to have little relevance for explaining support for differentiated integration [@leuffen_public_2020].

My second set of variables measures support for the national government and underlying Eurosceptic attitudes. Both are shown to explain support for uniform and differentiated integration [@armingeon_loss_2014; @de_blok_blessing_2020; @harteveld_europe_2013). I operationalize Euroscepticism as a dummy that asks people whether they would vote to leave the EU in a hypothetical referendum or not. I code all those answering yes as 1 and everyone else as 0. Support for the national government is operationalized by a dummy asking respondents whether they believe their nation's government is doing a good job. 

I operationalize identity through a widely used question that asks respondents to rank the inclusiveness of their identities. I construct a dummy where those answering that they identify solely with their nation-states are coded as 1 and everyone else as 0. While nested identities combining a national and European component are most common [@risse_euro_2003; @starke_concept_2021], previous literature finds that the distinction between exclusively national and territorially partially inclusive identities is more important for producing Euroscepticism than variations between different configurations of nested identities [@hooghe_calculation_2005].

I then use ideology and gender as socio-political control variables meant to isolate the effect of identity. These are established predictors of support for both general and specific integration (see for example @carrubba_decision_2004; @hobolt_public_2015; @hooghe_calculation_2005; @schoen_identity_2008). I operationalise ideology through a 7-unit scale, with 0 representing far-left and 6 far-right positions. Previous literature also finds evidence that a curvilinear correlation between ideology and support for the EU may exist, with left- and right wing non-centrist ideology both correlating with Euroscepticism [@toshkov_beyond_2022; @van_elsas_changing_2015]. I therefore add a squared indicator of left-right ideology.

## Limitations
A limitation of this study is that both surveys were fielded during the COVID-19 pandemic, which could impact support for differentiation. However, @cicchi_eu_2020 show that solidarity, as is common, seemed to still reside predominantly at the national level in the early phase of the crisis. This makes the results generalizable even beyond the period in which the survey was fielded. To account for the different baseline levels of support for constitutional differentiation, as well as how it is impacted by the COVID-19 pandemic, I use multilevel models with random country intercepts.

There are also large amounts of missingness on several of the variables (see table 1). Missing data may bias the results if they are correlated with individual-level characteristics like income, ideology, or gender. I test this bias through multiple imputation [@buuren_mice_2011] and show the results in the section Robustness checks.

A further limitation, general to all studies using observational survey data, is the possibility of omitted variable bias. In this study, omitted variable bias may stem from the absence of data on the respondents' knowledge of the EU and education [@karp_know_2003; @marquart_knowing_2019]. I use sensitivity analysis [@cinelli_making_2020] to tentatively quantify the size of this bias, and show the results of these analyses in the section Robustness checks.

```{r descriptive table 1, results='hide', message=FALSE, warning=FALSE}

load("EUI_merged.Rdata")
library(dplyr)
library(modelsummary)

data_descriptives <- EUI_final_merged %>%
  dplyr::select(article_log, opt_out_supp, market_europe, alternative_econ, 
                gov_trust, left_right,
                eurosceptic, left_right_sqr, gender, 
                excl_identity)

data_descriptives$excl_identity <- as.numeric(data_descriptives$excl_identity)

data_descriptives$eurosceptic <- as.numeric(data_descriptives$eurosceptic)


#Recode gender
data_descriptives$eurosceptic[data_descriptives$eurosceptic == 1] <- 0
data_descriptives$eurosceptic[data_descriptives$eurosceptic == 2] <- 1

#Recode exclusively national
data_descriptives$excl_identity[data_descriptives$excl_identity == 1] <- 0
data_descriptives$excl_identity[data_descriptives$excl_identity == 2] <- 1

data_descriptives$gender[data_descriptives$gender == 1] <- 0
data_descriptives$gender[data_descriptives$gender == 2] <- 1


#Create factors
data_descriptives <- data_descriptives %>%
  rename(`Support constitutional DI` = opt_out_supp) %>%
  rename(`Article-years (logged)` = article_log) %>%
  rename(`Liberal economic values` = market_europe) %>%
  rename(`Perception of economy` = alternative_econ) %>%
  rename(`Support national government` = gov_trust) %>%
  rename(`Left-right` = left_right) %>%
  rename(`Left-right (sqr.)` = left_right_sqr) %>%
  rename(`Eurosceptic` = eurosceptic) %>%
  rename(`Gender` = gender) %>%
  rename(`Exclusive identity` = excl_identity)
```

```{r descriptive table, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
datasummary_skim(data_descriptives, title = "Descriptive statistics", 
                 histogram = FALSE)

```

# Results and discussion
I  first show the effect of the interaction between the log-transformed variable for article-years and Euroscepticism on support for constitutional differentiated integration. I then discuss the effect of differentiation in support for differentiation in both Scandinavia and Central and Eastern Europe.  
```{r model 1, results='hide', message=FALSE, warning=FALSE}
library(lme4)
opt_out_eurosceptic <- lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                              eurosceptic + gender + excl_identity + article_log*eurosceptic + (1|country), weights = EUI_final_merged$weight, 
                            data = EUI_final_merged)

summary(opt_out_eurosceptic)

```

```{r table 2, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
library(stargazer)

stargazer(opt_out_eurosceptic,
          dep.var.caption	= c("Support for constitutional differentiated integration"), dep.var.labels.include = FALSE,
          covariate.labels = c("Constant","Article-years (logged)", "Support for free-market Europe", "Perception of economy", "Support for national government",
                               "Left-right","Left-right (sqr.)", "Eurosceptic", "Gender", "Exclusively national identity",
                               "Article-years (logged) X Eurosceptic"),
          keep.stat = c("n","aic"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001), intercept.top = TRUE, intercept.bottom = FALSE,
          type = "latex", notes.align = "l", notes.append = TRUE, no.space = TRUE,
          font.size = "small", column.sep.width = "-100pt", header = FALSE,
          title = "Support for constitutional differentiated integration with interaction between Euroscepticism and exposure to differentiation")
```

```{r figure 1, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="Predicted probability of support for constitutional differentiation as a function of the interaction between article-years (logged) and Euroscepticism. 95% CIs.", fig.pos= "H"}
library(sjPlot)
library(ggplot2)

pred_plot_eurosceptic <- plot_model(opt_out_eurosceptic, type = "pred", terms = c("article_log", "eurosceptic"), 
                                    colors = "bw", legend.title = "Eurosceptic")

pred_plot_eurosceptic_final <-  pred_plot_eurosceptic + ggtitle("Support for constitutional differentiation") + labs(x = "Differentiation (article-years (logged))",
                                                                                                                     y = "Predicted value")
pred_plot_eurosceptic_final

```

Figure 1 indicates clear support for *H4*, that Eurosceptics will express stronger support for differentiation as a result of exposure to differentiation than what is the case for supporters of EU membership. This pattern repeats itself for most levels of differentiated integration, with insignificant differences between the two groups found only where citizens have been least exposed. 

This may, as previously stated, be because Eurosceptic citizens in countries with greater exposure to differentiated integration are likelier to treat differentiated integration as a viable alternative to the European disintegration they might otherwise favour. In this sense, differentiation may be treated as a "second-best" alternative. However, one should not underestimate the fact that exposure to differentiated integration also increases support for a more differentiated EU among those who do not actively reject their country’s membership of the EU. It thus appears likely that future demands for differentiated integration will not be restricted only to Eurosceptic segments of the population

An alternative explanation for the correlation between exposure to differentiation and support for future differentiated integration could be that differentiation was primarily chosen where underlying Euroscepticism, and thus a demand for less integration, was already high. Figure A10 may offer some support for this, as Denmark and Sweden are among the countries in which the very high levels of differentiated integration can be explained by attempts to mitigate popular Euroscepticism [@leruth_operationalizing_2015; @spendzharova_banking_2016] However, countries as diverse as Lithuania, Hungary, Italy, and the Netherlands have also experienced differentiations from EU treaties. Differentiated integration is thus not restricted to what @bolstad_dynamics_2015 identifies as a Eurosceptic periphery. This strengthens the case that the relationship is not driven by strongly Eurosceptic outliers.

I next analyse how support for constitutional differentiation is shaped by the fact that differentiation is voluntarily chosen by testing whether support for constitutional differentiated integration is greater in Denmark and Sweden, two countries that have a long history of using differentiated integration to strengthen national autonomy [@adler-nissen_opting_2014; @leruth_operationalizing_2015].

```{r model 2, results='hide', message=FALSE, warning=FALSE}
library(lme4)
EUI_final_nordic <- EUI_final_merged %>%
  dplyr::filter(nordic_dummy == 1)

#Run analysis
opt_out_nordics <- lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                          eurosceptic + gender + excl_identity + (1|country), weights = EUI_final_nordic$weight, 
                        data = EUI_final_nordic)

summary(opt_out_nordics)
```

```{r table 3, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
library(stargazer)

stargazer(opt_out_nordics,
          dep.var.caption	= c("Support for constitutional differentiated integration"), dep.var.labels.include = FALSE,
          covariate.labels = c("Constant","Article-years (logged)", "Support for free-market Europe", "Perception of economy", "Support for national government",
                               "Left-right","Left-right (sqr.)", "Eurosceptic", "Gender", "Exclusively national identity"),
          keep.stat = c("n","aic"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001), intercept.top = TRUE, intercept.bottom = FALSE,
          type = "latex", notes.align = "l", notes.append = TRUE, no.space = TRUE,
          font.size = "small", column.sep.width = "-50pt", header = FALSE,
          title = "Support for constitutional differentiated integration in Scandinavia")
```

Table 3 shows that the effect of exposure to differentiated integration in Scandinavia is large, but statistically insignificant. We thus find little conclusive support for the hypothesis that support for differentiated integration is greater where it is voluntarily chosen, rather than externally imposed.

```{r figure 2, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="Predicted probability of support for constitutional differentiation in Sweden and Denmark. 95% CIs.", fig.pos= "H"}
library(sjPlot)
library(ggplot2)

pred_plot_nordics <- plot_model(opt_out_nordics, type = "pred", terms = "article_log")

pred_plot_nordics_final <-  pred_plot_nordics + ggtitle("Support for constitutional differentiation (Scandinavia)") + labs(x = "Differentiation (article-years (logged)",
                                                                                                                           y = "Predicted value")
pred_plot_nordics_final

```

Figure 2 corroborates this picture: We find only small increases in support for constitutional differentiated integration among Scandinavian citizens as exposure to differentiation increases. The very large confidence intervals furthermore underline the uncertainty of these predicted values. The appendix shows that this pattern is found among both Eurosceptics and supporters of EU membership in the Scandinavian countries.

One last question is whether exposure to largely involuntary differentiated integration lowers support for differentiated integration in the longer run. To test this, I show the effect of exposure to differentiated integration in Central and Eastern Europe.

```{r r model 3, results='hide', message=FALSE, warning=FALSE}
library(lme4)
EUI_final_CEE <- EUI_final_merged %>%
  dplyr::filter(CEE_dummy == 1)

#Run opt-out for CEE
opt_out_CEE <- lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                      eurosceptic + gender + excl_identity + (1|country), weights = EUI_final_CEE$weight, 
                    data = EUI_final_CEE)

summary(opt_out_CEE)
```

```{r table 4, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
library(stargazer)

stargazer(opt_out_CEE,
          dep.var.caption	= c("Support for constitutional differentiated integration"), dep.var.labels.include = FALSE,
          covariate.labels = c("Constant","Article-years (logged)", "Support for free-market Europe", "Perception of economy", "Support for national government",
                               "Left-right","Left-right (sqr.)", "Eurosceptic", "Gender", "Exclusively national identity"),
          keep.stat = c("n","aic"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001), intercept.top = TRUE, intercept.bottom = FALSE,
          type = "latex", notes.align = "l", notes.append = TRUE, no.space = TRUE,
          font.size = "small", column.sep.width = "-50pt", header = FALSE,
          title = "Support for constitutional differentiated integration in Central and Eastern Europe")
```

The table shows that there is a small effect of exposure to differentiated integration in Central and Eastern Europe, but that the effect is statistically insignificant. This suggests that the effects of exposure to differentiation, whether positive or negative, are limited. 

```{r figure 3, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="Predicted probability of support for constitutional differentiation in Central and Eastern Europe. 95% CIs.", fig.pos= "H"}
library(sjPlot)
library(ggplot2)

pred_plot_CEE <- plot_model(opt_out_CEE, type = "pred", terms = "article_log")

pred_plot_CEE_final <-  pred_plot_CEE + ggtitle("Support for constitutional differentiation (Central and Eastern Europe)") + labs(x = "Differentiation (article-years (logged)",
                                                                                                                                  y = "Predicted value")
pred_plot_CEE_final

```

The predicted support shown by figure 3 largely corroborates this result. This weakens support for *H2*, that support will decrease as a function of exposure to differentiation, while offering tentative support for *H1*, stating the opposite. However, the lack of statistical significance means that the results should not be treated as definitive proof of a positive correlation. The true direction of the feedback loop between exposure to and support for differentiation is thus unclear.

The interaction between Euroscepticism and exposure to differentiated integration in Central and Eastern Europe (shown by figure A1) nuances the broader story of this paper: Eurosceptic individuals in Central and Eastern Europe are less likely to support differentiated integration if they have been exposed to greater amounts of it in the past. The first explanation for this may of course be that these citizens' primary exposure to differentiated integration was as something involuntary and externally imposed. However, another reason may be that their greater exposure to differentiated integration could have made them more responsive to elite cueing of differentiated integration as a potential threat to the nation's influence within the EU. Such frames have been especially prevalent in Polish debates about the future shape of the EU [@cianciara_differentiated_2014]. The fact that regional circumstances and cues potentially play a greater role than historical trajectories of integration is also evident in how increasing opposition to European differentiation among Eurosceptics is also found in those countries with the highest levels of exposure to differentiated integration in Southern Europe (see figure A11).

The fact that the surveys were fielded at the height of the COVID-19 pandemic means that we may be seeing lower levels of support for differentiated integration than we would at other times: As @genschel_postfunctionalism_2021 argue, the COVID-19 pandemic “debordered” solidarity, making the prospect of mutual aid across member state borders more attractive to EU citizens. In times where EU solidarity is positively framed, support for differentiation integration may be lower than it otherwise would have been. More research is thus needed to establish whether the patterns established by this paper are consistent also in the future.

# Robustness checks

I use an approach outlined in @cinelli_making_2020 test the sensitivity of all models to omitted variable bias (see figures A3-8). I thus test the variance that a potential confounder would need to account for to nullify the effect of theoretical interest, exposure to differentiated integration. This shows that all models, to varying degrees, are sensitive to such bias. For instance, the test of the model showing the effect of article-years on support for constitutional differentiated integration in Scandinavia (figure A5) shows that a variable explaining 50% of the remaining variance of support for constitutional differentiation would need to explain less than 10% of the remaining variance in real exposure to differentiation for the effect of exposure to reach zero. This is in line with what is found for the other models. One important omitted variable is potentially knowledge of the EU [@leuffen_public_2020]. While knowledge of the EU is unlikely to be strongly connected with actual levels of differentiation, the tests show that omitted variable bias remains a concern for this study

I next use chained equation multiple imputation [@buuren_mice_2011; @fjelstul_explaining_2022] to test how sensitive the results are to bias induced by missing data. Multiple imputation uses each unit's observed data to derive probable values for all covariates with missing values. Each model is imputed 25 times, before the imputations are pooled to provide multiply imputed parameter estimates and standard errors. This better accounts for the inherent uncertainty associated with data imputation. As appendix tables A4-6 show, the multiply imputed models are similar to those from tables 2-4. One important exception is the effect of exposure to differentiated integration in Central and Eastern Europe: While there is a weak, and insignificant, positive effect of exposure in the main model, the multiply imputed model shows an insignificant, weakly negative, effect. Despite this, the tests suggest that the effects established in this paper are not primarily driven by systematic data missingness.

Lastly, I test the robustness of the results to an alternative specification of Euroscepticism: satisfaction with EU democracy. Dissatisfaction with the state of EU democracy can be seen as a less stringent form of Euroscepticism than wanting one's country to leave the EU. Figure A9 shows the same trend as the main results: Those with the lowest levels of satisfaction with EU democracy, and who arguably have the strongest Eurosceptic sentiments, express the greatest support for constitutional differentiated integration. Their support for differentiation also increases more strongly as a function of exposure to previous differentiation than what is the case for less Eurosceptic groups. Both facts strengthen my original conclusions.

# Concluding discussion
This paper establishes, through both recent survey data and data outlining all differentiations from the EU treaties, that there is a positive feedback loop between exposure to differentiated integration and support for more future EU differentiation. This may be because, as citizens become more and more accustomed to such differentiated membership of the EU, it may be perceived as a more favourable way of combining the benefits of national membership of the EU with extended national autonomy. I also show that this particularly applies to those sceptical of their countries' EU membership, who may see differentiation as a "second-best" alternative to European disintegration

There is one exception to this rule: Eurosceptic citizens of the Central and Eastern European countries are less favourably inclined towards differentiated integration if they live in countries with greater exposure to differentiated integration. I point to two competing explanations for why this may be the case: First, the largely involuntary and externally imposed differentiation that Central and Eastern European citizens have primarily been exposed to could shape Eurosceptic attitudes towards differentiation in this region. The fact that these citizens were excluded from for instance the freedom of movement for workers, a highly salient area that would be beneficial to individual citizens [schimmelfennig_eu_2014], could be one source of the negative attitudes found among Eurosceptics. Secondly, these individuals may be more concerned with maintaining national power than those identifying with support for a membership of the EU that necessarily implies ceding some sovereignty to a European political level. Eurosceptics may thus be more attentive to elite's discursive framing of differentiated integration as a path towards a second-rate membership for the Central and Eastern European member states and adjust their attitudes accordingly.

My results open two avenues of future research: It is first important to establish whether cues regarding European integration in general shape views of differentiated integration, and what kind of cues are most important for developing preferences for such differentiation. It may for instance be the case that those who are exposed to Eurosceptic news content may respond not with explicit Euroscepticism, but by developing preferences for a more differentiated Europe. The true impact of cues on such preferences, how and when Eurosceptic cues may produce for differentiation rather than disintegration, and what the circumstances of implementation means for public support are important questions that should be studied using both large-*N* approaches and experimental methods. 

The second avenue for future research deals with the question of whether the public is equally likely to prefer differentiation in all policy areas. Existing research [de_blok_blessing_2020; @leuffen_public_2020] has largely focused on individual support for polity-level differentiation of the EU. It is both possible and probable that even those favouring an “ever closer union” may have diverging preferences for integration at the level of individual policies. Testing this proposition may allow us to develop models for understanding when people will express ambivalent, rather than overtly critical, attitudes towards European integration [@de_vries_variable_2013; @goldberg_one_2021].

My results also have implications for the literatures on differentiated integration, the post-crisis EU and the drivers of support for transnational cooperation: They suggest that the increasing use of differentiation may prove problematic for an EU that is still normatively committed to the idea of “ever closer Union”. The clear connection between exposure to differentiation and preference for it as a way organizing a European political community may also offer insights into the possible consequences of allowing for greater legal flexibility for non-European transnational cooperations seeking greater political integration in the future. 

# References
<div id="refs"></div>

\newpage
# Appendix

```{r model A1, results='hide', message=FALSE, warning=FALSE}
CEE_eurosceptic <- lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                      eurosceptic + gender + excl_identity + article_log*eurosceptic + (1|country), weights = EUI_final_CEE$weight, 
                    data = EUI_final_CEE)

summary(CEE_eurosceptic)
```

\setcounter{figure}{0}
\renewcommand*{\thefigure}{A\arabic{figure}}
```{r figure A1, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="Support for differentiated integration in Central and Eastern Europe as an interaction between Euroscepticism and exposure to differentiated integration. 95% CIs.", fig.pos= "H"}

pred_plot_CEE_eurosceptic <- plot_model(CEE_eurosceptic, type = "pred", terms = c("article_log", "eurosceptic"), 
                                        legend.title = "Eurosceptic", colors = "bw")

pred_plot_CEE_eurosceptic_final <-  pred_plot_CEE_eurosceptic + ggtitle("Support for constitutional differentiation (Central and Eastern Europe)") + labs(x = "Differentiation (article-years (logged)",
                                                                                                                                                          y = "Predicted value")
pred_plot_CEE_eurosceptic_final
```

\setcounter{table}{0}
\renewcommand*{\thetable}{A\arabic{table}}
```{r table A1, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
stargazer(CEE_eurosceptic,
          dep.var.caption	= c("Support for constitutional differentiated integration (Central and Eastern Europe)"), dep.var.labels.include = FALSE,
          covariate.labels = c("Constant","Article-years (logged)", "Support for free-market Europe", "Perception of economy", "Support for national government",
                               "Left-right","Left-right (sqr.)", "Eurosceptic", "Gender", "Exclusively national identity", 
                               "Article-years (logged) X Euroscepticism"),
          keep.stat = c("n","aic"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001), intercept.top = TRUE, intercept.bottom = FALSE,
          type = "latex", title = "Table showing interaction between exposure to differentiated integration and Euroscepticism in Central and Eastern Europe", header = FALSE, column.sep.width = "-150pt")
```

```{r model A3, results='hide', message=FALSE, warning=FALSE}
opt_out_nordics_eurosceptic <- lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                                      eurosceptic + gender + excl_identity + article_log*eurosceptic + (1|country), weights = EUI_final_nordic$weight, 
                                    data = EUI_final_nordic)

summary(opt_out_nordics_eurosceptic)
```

```{r figure A2, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="Support for differentiated integration in Scandinavia as an interaction between Euroscepticism and exposure to differentiated integration. 95% CIs.", fig.pos= "H"}
pred_plot_nordics_eurosceptic <- plot_model(opt_out_nordics_eurosceptic, type = "pred", terms = c("article_log", "eurosceptic"),
                                            legend.title = "Eurosceptic", colors = "bw")

pred_plot_nordics_eurosceptic_final <-  pred_plot_nordics_eurosceptic + ggtitle("Support for constitutional differentiation (Scandinavia)") + labs(x = "Differentiation (article-years (logged)",
                                                                                                                                                   y = "Predicted value")

pred_plot_nordics_eurosceptic_final

```

\renewcommand*{\thetable}{A\arabic{table}}
```{r table A2, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
stargazer(opt_out_nordics_eurosceptic,
          dep.var.caption	= c("Support for constitutional differentiated integration (Scandinavia)"), dep.var.labels.include = FALSE,
          covariate.labels = c("Constant","Article-years (logged)", "Support for free-market Europe", "Perception of economy", "Support for national government",
                               "Left-right","Left-right (sqr.)", "Eurosceptic", "Gender", "Exclusively national identity", 
                               "Article-years (logged) X Eurosceptic"),
          keep.stat = c("n","aic"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001), intercept.top = TRUE, intercept.bottom = FALSE,
          type = "latex", header = FALSE, title = "Table showing interaction between exposure to differentiated integration and Euroscepticism in Scandinavia", column.sep.width = "-100pt")
```

```{r model table A3, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(sensemakr)

EUI_final_merged$diffsupp = EUI_final_merged$opt_out_supp
EUI_final_merged$diffsum = EUI_final_merged$article_log

optout_nointeract <- lm(diffsupp ~ diffsum + alternative_econ + gov_trust + left_right + left_right_sqr +
eurosceptic + gender + excl_identity + factor(country), weights = EUI_final_merged$weight, 
data = EUI_final_merged)

summary(optout_nointeract)
```

```{r table A3, message=FALSE, warning=FALSE, echo=FALSE, results='hide'}
#Sensitivity analyses
library(sensemakr)

sensitivity_optout <- sensemakr(optout_nointeract, 
                                           treatment = "diffsum")

summary(sensitivity_optout)
```

\renewcommand*{\thefigure}{A\arabic{figure}}
```{r figure A3, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="Omitted variable bias in un-interacted model. Analysis of size of confounding effect and its impact on effect size."}
library(sensemakr)

plot(sensitivity_optout, type = "extreme")
```


```{r model table A4, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(sensemakr)
optout_interact <- lm(diffsupp ~ diffsum + alternative_econ + gov_trust + left_right + left_right_sqr +
                        eurosceptic + gender + excl_identity + diffsum*eurosceptic + factor(country), weights = EUI_final_merged$weight, 
                      data = EUI_final_merged)

summary(optout_interact)

sensitivity_interact <- sensemakr(optout_interact, 
                                  treatment = "diffsum:eurosceptic1")

summary(sensitivity_interact)
```

```{r figure A4, echo=FALSE, warning=FALSE, message=FALSE, results='asis', fig.cap="Omitted variable bias in interacted model. Analysis of size of confounding effect and its impact on effect size"}
plot(sensitivity_interact, type = "extreme")
```

```{r model figure A5, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}

optout_nordic_fixeff <- lm(opt_out_supp ~ article_log + alternative_econ + gov_trust + left_right + left_right_sqr +
                             eurosceptic + gender + excl_identity + factor(country), weights = EUI_final_nordic$weight, 
                           data = EUI_final_nordic)

summary(optout_nordic_fixeff)

#Run sensitivity analysis
sensitivity_optout_nordic <- sensemakr(optout_nordic_fixeff, 
                                       treatment = "article_log")

summary(sensitivity_optout_nordic)
```

```{r figure A5, echo=FALSE, warning=FALSE, message=FALSE, results='asis', fig.cap="Omitted variable bias in un-interacted model of Scandinavian data. Analysis of size of confounding effect and its impact on effect size"}

plot(sensitivity_optout_nordic, type = "extreme")
```

```{r model figure A6, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}

optout_nordic_fixeff_interact <- lm(two_speed_supp ~ article_log + alternative_econ + gov_trust + left_right + left_right_sqr +
                                      eurosceptic + gender + excl_identity + article_log*eurosceptic + factor(country), weights = EUI_final_nordic$weight, 
                                    data = EUI_final_nordic)

summary(optout_nordic_fixeff_interact)

sensitivity_interact_nordic <- sensemakr(optout_nordic_fixeff_interact, 
                                         treatment = "article_log:eurosceptic1")

summary(sensitivity_interact_nordic)
```

```{r figure A6, echo=FALSE, warning=FALSE, message=FALSE, results='asis', fig.cap="Omitted variable bias in interacted model of Scandinavian data. Analysis of size of confounding effect and its impact on effect size"}
plot(sensitivity_interact_nordic, type = "extreme")
```

```{r model figure A7, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
optout_CEE_fixeff <- lm(opt_out_supp ~ article_log + alternative_econ + gov_trust + left_right + left_right_sqr +
                          eurosceptic + gender + excl_identity + factor(country), weights = EUI_final_CEE$weight, 
                        data = EUI_final_CEE)

summary(optout_CEE_fixeff)

#Run sensitivity analysis
sensitivity_optout_CEE <- sensemakr(optout_CEE_fixeff, 
                                    treatment = "article_log")

summary(sensitivity_optout_CEE)
```

```{r figure A7, echo=FALSE, warning=FALSE, message=FALSE, results='asis', fig.cap="Omitted variable bias in un-interacted model of Central and Eastern European data. Analysis of size of confounding effect and its impact on effect size"}
plot(sensitivity_optout_CEE, type = "extreme")
```

```{r model figure A8, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}

optout_CEE_fixeff_interact <- lm(two_speed_supp ~ article_log + alternative_econ + gov_trust + left_right + left_right_sqr +
                                   eurosceptic + gender + excl_identity + article_log*eurosceptic + factor(country), weights = EUI_final_CEE$weight, 
                                 data = EUI_final_CEE)

summary(optout_CEE_fixeff_interact)

#Run sensitivity analysis
sensitivity_interact_CEE <- sensemakr(optout_CEE_fixeff_interact, 
                                      treatment = "article_log:eurosceptic1")

summary(sensitivity_interact_CEE)
```

```{r figure A8, echo=FALSE, warning=FALSE, message=FALSE, results='asis', fig.cap="Omitted variable bias in interacted model of Central and Eastern data. Analysis of size of confounding effect and its impact on effect size"}
plot(sensitivity_interact_CEE, type = "extreme")
```

```{r fa, echo=FALSE, warning=FALSE, message=FALSE, results='hide', include=FALSE}
library(psychTools)
library(psych)
economy_index_EUI <- EUI_final_merged %>%
  dplyr::select(personal_financial, economic_situation_nation, 
                employment_area) %>%
    rename(`Personal economic situation` = personal_financial) %>%
  rename(`National economic situation` = economic_situation_nation) %>%
  rename(`Employment opportunities of local areas` = employment_area) %>%
  na.omit()

economy_index_EUI <- as.data.frame(economy_index_EUI)

econ_fa <- psych::fa(economy_index_EUI, nfactors = 2)
```

```{r table_fa, echo=FALSE, warning=FALSE, message=FALSE, results='asis'}
cat(fa2latex(econ_fa, caption="Factor analysis of perception of economy",
         heading= "Factor loading cutoff: > 0.5", silent = TRUE))

```

```{r mi_complete, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(sandwich)
library(mice)
library(miceadds)
library(dplyr)
library(broom)
library(broom.mixed)
library(kableExtra)

load("multiple_impute.Rdata")

mice_optout <- with(multiple_impute_EUI, lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                                                eurosceptic + gender + excl_identity + article_log*eurosceptic + (1|country), weights = multiple_impute_EUI$weight))

summary(pool(mice_optout))

result_data <- data.frame(summary(pool(mice_optout)), 
                             stringsAsFactors = FALSE)



#Rename
result_data <- result_data %>%
  rename(`Variable` = term) %>%
  rename(`Estimate` = estimate) %>%
  rename(`Std. error` = std.error) %>%
  rename(`T-statistic` = statistic) %>%
  rename(`DFs` = df) %>%
  rename(`p-value` = p.value)

result_data$Variable <- as.character(result_data$Variable)

result_data$Variable[result_data$Variable == "(Intercept)"] <- "Constant"
result_data$Variable[result_data$Variable == "article_log"] <- "Article-years (logged)"
result_data$Variable[result_data$Variable == "market_europe"] <- "Liberal economic values"
result_data$Variable[result_data$Variable == "alternative_econ"] <- "Perception of economic situation"
result_data$Variable[result_data$Variable == "gov_trust"] <- "Support national government"
result_data$Variable[result_data$Variable == "left_right"] <- "Left-right"
result_data$Variable[result_data$Variable == "left_right_sqr"] <- "Left-right (sqr.)"
result_data$Variable[result_data$Variable == "eurosceptic1"] <- "Eurosceptic"
result_data$Variable[result_data$Variable == "gender"] <- "Gender"
result_data$Variable[result_data$Variable == "excl_identity1"] <- "Exclusively national identity"
result_data$Variable[result_data$Variable == "article_log:eurosceptic1"] <- "Article-years (logged) X Eurosceptic"

```

```{r texreg, results='asis', warning=FALSE, echo=FALSE, warning=FALSE}
knitr::kable(result_data, digits = 3, format = "latex",
             caption = "Multiply imputed multilevel model with interaction")
```

```{r mi_complete_nordic, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(sandwich)
library(mice)
library(miceadds)
library(dplyr)
library(broom)
library(broom.mixed)

load("multiple_impute_nordic.Rdata")
mice_optout_nordic <- with(multiple_impute_nordic, lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                                                eurosceptic + gender + excl_identity + (1|country), weights = EUI_final_nordic$weight))

summary(pool(mice_optout_nordic))

result_data_nordic <- data.frame(summary(pool(mice_optout_nordic)), 
                             stringsAsFactors = FALSE)



#Rename
result_data_nordic <- result_data_nordic %>%
  rename(`Variable` = term) %>%
  rename(`Estimate` = estimate) %>%
  rename(`Std. error` = std.error) %>%
  rename(`T-statistic` = statistic) %>%
  rename(`DFs` = df) %>%
  rename(`p-value` = p.value)

result_data_nordic$Variable <- as.character(result_data_nordic$Variable)

result_data_nordic$Variable[result_data_nordic$Variable == "(Intercept)"] <- "Constant"
result_data_nordic$Variable[result_data_nordic$Variable == "article_log"] <- "Article-years (logged)"
result_data_nordic$Variable[result_data_nordic$Variable == "market_europe"] <- "Liberal economic values"
result_data_nordic$Variable[result_data_nordic$Variable == "alternative_econ"] <- "Perception of economic situation"
result_data_nordic$Variable[result_data_nordic$Variable == "gov_trust"] <- "Support national government"
result_data_nordic$Variable[result_data_nordic$Variable == "left_right"] <- "Left-right"
result_data_nordic$Variable[result_data_nordic$Variable == "left_right_sqr"] <- "Left-right (sqr.)"
result_data_nordic$Variable[result_data_nordic$Variable == "eurosceptic1"] <- "Eurosceptic"
result_data_nordic$Variable[result_data_nordic$Variable == "gender"] <- "Gender"
result_data_nordic$Variable[result_data_nordic$Variable == "excl_identity1"] <- "Exclusively national identity"
result_data_nordic$Variable[result_data_nordic$Variable == "article_log:eurosceptic1"] <- "Article-years (logged) X Eurosceptic"

```

```{r kable_complete_nordic, results='asis', warning=FALSE, echo=FALSE, warning=FALSE}
library(kableExtra)
knitr::kable(result_data_nordic, digits = 3, format = "latex",
             caption = "Multiply imputed multilevel model (Scandinavia)")
```

```{r mi_complete_CEE, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
library(sandwich)
library(mice)
library(miceadds)
library(dplyr)
library(broom)
library(broom.mixed)

load("multiple_impute_CEE.Rdata")

mice_optout_CEE <- with(multiple_impute_CEE, lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                                                eurosceptic + gender + excl_identity + (1|country), weights = EUI_final_CEE$weight))

summary(pool(mice_optout_CEE))

result_data_CEE <- data.frame(summary(pool(mice_optout_CEE)), 
                             stringsAsFactors = FALSE)



#Rename
result_data_CEE <- result_data_CEE %>%
  rename(`Variable` = term) %>%
  rename(`Estimate` = estimate) %>%
  rename(`Std. error` = std.error) %>%
  rename(`T-statistic` = statistic) %>%
  rename(`DFs` = df) %>%
  rename(`p-value` = p.value)

result_data_CEE$Variable <- as.character(result_data_CEE$Variable)

result_data_CEE$Variable[result_data_CEE$Variable == "(Intercept)"] <- "Constant"
result_data_CEE$Variable[result_data_CEE$Variable == "article_log"] <- "Article-years (logged)"
result_data_CEE$Variable[result_data_CEE$Variable == "market_europe"] <- "Liberal economic values"
result_data_CEE$Variable[result_data_CEE$Variable == "alternative_econ"] <- "Perception of economic situation"
result_data_CEE$Variable[result_data_CEE$Variable == "gov_trust"] <- "Support national government"
result_data_CEE$Variable[result_data_CEE$Variable == "left_right"] <- "Left-right"
result_data_CEE$Variable[result_data_CEE$Variable == "left_right_sqr"] <- "Left-right (sqr.)"
result_data_CEE$Variable[result_data_CEE$Variable == "eurosceptic1"] <- "Eurosceptic"
result_data_CEE$Variable[result_data_CEE$Variable == "gender"] <- "Gender"
result_data_CEE$Variable[result_data_CEE$Variable == "excl_identity1"] <- "Exclusively national identity"
result_data_CEE$Variable[result_data_CEE$Variable == "article_log:eurosceptic1"] <- "Article-years (logged) X Eurosceptic"

```

```{r kable_complete_CEE, results='asis', warning=FALSE, echo=FALSE, warning=FALSE}
library(kableExtra)
knitr::kable(result_data_CEE, digits = 3, format = "latex",
             caption = "Multiply imputed multilevel model (Central and Eastern Europe)")
```

```{r alt_eurosceptic, results='hide', warning=FALSE, echo=FALSE, message=FALSE}
opt_out_main_interact <-lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                               eu_democ_satisf + gender + excl_identity + article_log*eu_democ_satisf + 
                               (1|country), weights = EUI_final_merged$weight, 
                             data = EUI_final_merged)

summary(opt_out_main_interact)
```

```{r alt_eurosceptic stargazer, results='asis', warning=FALSE,echo=FALSE, message=FALSE}
stargazer(opt_out_main_interact,
          dep.var.caption	= c("Support for constitutional differentiated integration"), dep.var.labels.include = FALSE,
          covariate.labels = c("Constant","Article-years (logged)", "Support for free-market Europe", "Perception of economy", "Support for national government",
                               "Left-right","Left-right (sqr.)", "EU democracy satisfaction", "Gender", "Exclusively national identity", 
                               "Article-years (logged) X EU democracy satisfaction"),
          keep.stat = c("n","aic"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001), intercept.top = TRUE, intercept.bottom = FALSE, column.sep.width = "-100pt",
          type = "latex", header = FALSE, title = "Main model with alternative specification of Euroscepticism")
```

```{r alt_euro fig, message=FALSE, warning=FALSE, echo=FALSE, results='asis', fig.cap= "Predicted values of support for constitutional differentiated integration as a function of an interaction between exposure to differentiated integration and satisfaction with EU democracy. Slopes for minimum, median and maximum values of satisfaction with EU democracy are shown. 95% CIs.", fig.pos= "H"}
pred_plot_interact_main <- plot_model(opt_out_main_interact, type = "pred", terms = c("article_log", "eu_democ_satisf"), 
                                      colors = "bw", legend.title = "EU democracy satisfaction")

pred_plot_interact_main_final <-  pred_plot_interact_main + ggtitle("Support for constitutional differentiation", 
                                                                    subtitle = "Interaction between EU democracy satisfaction and differentiation") + labs(x = "Differentiation (article-years (logged)",
                                                                                                                                                           y = "Predicted value")
pred_plot_interact_main_final
```

```{r diff_by_country, message=FALSE, warning=FALSE, echo=FALSE, results='asis', fig.cap= "Number of differentiations from EU primary law 1952-2020 (log-transformed article-years) by EU member state.", fig.pos= "H"}
library(ggplot2)
bar_chart_articleyear <- ggplot(EUI_final_merged, aes(x = factor(country), y = article_log)) +
  geom_col(stat = "identity", position = "dodge")

bar_chart_articleyear + labs(x = "Country", y = "Article-years (log-transformed)") +
  scale_x_discrete(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14),
                   labels = c("UK", "DK", "FI", "FR", "DE", "SE", "GR", "HU", "IT",
                              "LT", "NL", "PL", "RO", "ES")) +
  ggtitle(label = "Differentiated integration in the EU", 
          subtitle = "Primary law differentiations (article-years log-transformed) by country")
```

```{r southern_fig_model, message=FALSE, warning=FALSE, echo=FALSE, results='hide'}

EUI_final_southern <- EUI_final_merged %>%
  dplyr::filter(south_dummy == 1)

##Create regression
opt_out_southern <- lmer(opt_out_supp ~ article_log + market_europe + alternative_econ + gov_trust + left_right + left_right_sqr +
                          eurosceptic + gender + excl_identity + (1|country), weights = EUI_final_southern$weight, 
                        data = EUI_final_southern)

summary(opt_out_southern)
```

```{r southern_fig, fig.cap="Support for differentiated integration in Southern Europe as an interaction between Euroscepticism and exposure to differentiated integration. 95% CIs.", fig.pos= "H", results='asis', warning=FALSE, message=FALSE, warning=FALSE, echo=FALSE}

pred_plot_southern <- plot_model(opt_out_southern, type = "pred", terms = "article_log")

pred_plot_southern_final <-  pred_plot_southern + ggtitle("Support for constitutional differentiation (Southern Europe)") + labs(x = "Differentiation (article-years (logged)",
                                                                                                                           y = "Predicted value")
pred_plot_southern_final
```

```{r southern_stargazer, results='asis', warning=FALSE, message=FALSE, echo=FALSE}

stargazer(opt_out_southern,
          dep.var.caption	= c("Support for constitutional differentiated integration in Southern Europe"), dep.var.labels.include = FALSE,
          covariate.labels = c("Constant","Article-years (logged)", "Support for free-market Europe", "Perception of economy", "Support for national government",
                               "Left-right","Left-right (sqr.)", "Eurosceptic", "Gender", "Exclusively national identity"),
          keep.stat = c("n","aic"),
          digits = 2,
          star.cutoffs = c(0.05, 0.01, 0.001), intercept.top = TRUE, intercept.bottom = FALSE,
          type = "latex", header = FALSE, column.sep.width = "-100pt", 
          title = "Table showing interaction between exposure to differentiated integration and support for differentiated integration in Southern Europe")
```

